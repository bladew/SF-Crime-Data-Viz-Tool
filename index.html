<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <title>Heatmaps</title>
        <link rel="stylesheet" type="text/css" href="css/style.css">
        <script src="https://maps.googleapis.com/maps/api/js?key=your_own_key&libraries=visualization"></script>
<script src="http://d3js.org/d3.v3.js"></script>
    </head>

    <body>
        <div id="floating-panel">
            <button onclick="toggle_heatmap()">Toggle Heatmap</button>
            <button onclick="changeRadius()">Change radius</button>
            <button onclick="change_fraud()">Fraud</button>
            <button onclick="change_robbery()">Robbery</button>
        </div>

        <div id="map"></div>
            <script>
                var map, heatmap,selected_category = "fraud",
                category = {"fraud":"data/fraud.csv","robbery":"data/robbery.csv"};

      function init_map() {
        map = new google.maps.Map(document.getElementById('map'), {
          zoom: 13,
          center: {lat: 37.775, lng: -122.434},
          mapTypeId: google.maps.MapTypeId.SATELLITE
        });

        heatmap = new google.maps.visualization.HeatmapLayer({
            map: map
        });
        set_data();
        console.log(heatmap.getData());
      }

      function toggle_heatmap() {
        heatmap.setMap(heatmap.getMap() ? null : map);
      }

      function changeRadius() {
        heatmap.set('radius', heatmap.get('radius') ? null : 20);
      }

      function change_fraud () {
          if (selected_category != "fraud") {
            selected_category = "fraud";
            set_data();
          };
      }

      function change_robbery () {
          if (selected_category != "robbery") {
            selected_category = "robbery";
            set_data();
          };
      }

      function set_data() {
            d3.csv(category[selected_category], 
                function(d) {
                    return new google.maps.LatLng(Number(d.Y), Number(d.X));
                }, 
                function(error, data) {
                    if (data.length > 20000) { data = data.slice(0,20000)};
                    heatmap.setData(data);
                    console.log(heatmap.getData().j)
                }
            );
    }

    init_map();
        </script>
    
    </body>
</html>
